# when.toml - Example Configuration File

[audio.capture]
enabled = true
sample_rate = 48000
channels = 2
ring_frames = 8192
device = ""
input_gain = 1.0
system = true

[audio.file]
enabled = false
path = ""
channels = 1
gain = 1.0

[audio]
prefer_file = false

[dsp]
fft_size = 1024
hop_size = 256
bands = 32
window = "hann"
smoothing_attack = 0.2
smoothing_release = 0.05
beat_sensitivity = 1.0
enable_flux = true
enable_spectral_flatness = true
enable_chroma = true

[visual]
target_fps = 60.0

[runtime]
show_metrics = true
allow_resize = true
beat_flash = true
show_overlay_metrics = true

[plugins]
directory = "plugins"
autoload = ["beat-flash-debug"]
safe_mode = false

[[animations]]
type = "AsciiMatrix"
z_index = 2
initially_active = false
glyphs_file_path = "assets/ascii_matrix.txt"
matrix_rows = 12
matrix_cols = 40
matrix_show_border = true
matrix_beat_boost = 2.0
matrix_beat_threshold = 0.55

[[animations]]
type = "Pleasure"
z_index = 3
initially_active = true
plane_rows = 24
plane_cols = 48
pleasure_magnitude_scale = 0.3
pleasure_history_smoothing = 0.18
pleasure_global_envelope_smoothing = 0.9 # higher for faster response
pleasure_profile_smoothing = 0.3
pleasure_ridge_magnitude_smoothing = 0.2
pleasure_ridge_position_smoothing = 0.95
pleasure_center_band_width = 0.42
pleasure_ridge_sigma = 0.06
pleasure_ridge_position_jitter = 0.05
pleasure_ridge_magnitude_jitter = 0.01
pleasure_ridge_interval_min = 0.3
pleasure_ridge_interval_max = 0.72
pleasure_min_ridges = 2
pleasure_max_ridges = 5
pleasure_line_spacing = 2
pleasure_max_lines = 48
pleasure_baseline_margin = 5
pleasure_max_upward_excursion = 30
pleasure_max_downward_excursion = 8
